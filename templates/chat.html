<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ğŸ’¬ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¨Ø³Ø§Ù… Ø§Ù„Ø°ÙƒÙŠ</title>
  <style>
    body{font-family:'Segoe UI',Tahoma,Arial,sans-serif;margin:0;background:#eef1ff;color:#222;direction:rtl}
    header{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:20px;text-align:center;position:sticky;top:0;z-index:10}
    header h1{margin:0;font-size:26px}
    main{max-width:800px;margin:20px auto;padding:10px}
    .chat-box{background:#fff;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.1);padding:16px;min-height:60vh;overflow-y:auto}
    .msg{margin:10px 0;padding:12px 16px;border-radius:14px;max-width:80%;white-space:pre-wrap}
    .user{background:#4f46e5;color:#fff;margin-left:auto;text-align:right}
    .bot{background:#f3f4f6;color:#111;margin-right:auto;text-align:right}
    form{display:flex;gap:8px;margin-top:14px}
    input[type=text]{flex:1;padding:12px;border:2px solid #ddd;border-radius:10px;font-size:15px}
    button{background:#4f46e5;color:#fff;border:0;padding:12px 18px;border-radius:10px;cursor:pointer;font-weight:bold}
    button:hover{background:#4338ca}
    .footer{margin-top:20px;text-align:center;font-size:13px;color:#666}
  </style>
</head>
<body>

<header>
  <h1>ğŸ¤– Ù…Ø­Ø§Ø¯Ø«Ø© Ø¨Ø³Ø§Ù… Ø§Ù„Ø°ÙƒÙŠ</h1>
  <p style="margin:4px 0 0;font-size:14px;opacity:.9">Ø§Ø³Ø£Ù„ Ø£ÙŠ Ø´ÙŠØ¡ â€“ Ø³Ø£Ø­Ø§ÙˆÙ„ Ø§Ù„ÙÙ‡Ù… ÙˆØ§Ù„Ø±Ø¯ ğŸ‘‡</p>
</header>

<main>
  <div class="chat-box" id="chatBox">
    <div class="msg bot">ğŸ‘‹ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ! Ø£Ù†Ø§ Ø¨Ø³Ø§Ù… Ø§Ù„Ø°ÙƒÙŠØŒ ÙƒÙŠÙ Ø£Ø³ØªØ·ÙŠØ¹ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ</div>
  </div>

  <form id="chatForm">
    <input id="msgInput" type="text" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..." required>
    <button type="submit">Ø¥Ø±Ø³Ø§Ù„ ğŸš€</button>
  </form>

  <div class="footer">BASSAM AI â€” Ù†Ø³Ø®Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø°ÙƒÙŠØ© ğŸŒ™</div>
</main>

<script>
const form = document.getElementById('chatForm');
const box = document.getElementById('chatBox');
const input = document.getElementById('msgInput');

// Ø¥Ø°Ø§ Ø¬Ø§Ø¡ Ø§Ø³ØªØ¹Ù„Ø§Ù… Ù…Ù† Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
const urlParams = new URLSearchParams(window.location.search);
const firstQuery = urlParams.get('query');
if(firstQuery){
  input.value = firstQuery;
  sendMsg(firstQuery);
}

form.addEventListener('submit', e=>{
  e.preventDefault();
  const text = input.value.trim();
  if(!text) return;
  sendMsg(text);
});

async function sendMsg(text){
  addMsg('user', text);
  input.value = '';
  scrollDown();
  try{
    const res = await fetch(`/ask?query=${encodeURIComponent(text)}`);
    const data = await res.json();
    const answer = data.result || "âŒ Ù„Ù… Ø£ÙÙ‡Ù… Ø³Ø¤Ø§Ù„Ùƒ Ø¨Ø¹Ø¯ØŒ Ø­Ø§ÙˆÙ„ Ø¨ØµÙŠØºØ© Ø£ÙˆØ¶Ø­.";
    addMsg('bot', answer);
  }catch(err){
    addMsg('bot', "âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù….");
  }
  scrollDown();
}

function addMsg(type, text){
  const div = document.createElement('div');
  div.className = `msg ${type}`;
  div.textContent = text;
  box.appendChild(div);
}

function scrollDown(){
  box.scrollTo({top: box.scrollHeight, behavior:'smooth'});
}
</script>

</body>
</html>
