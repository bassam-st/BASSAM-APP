<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bassam App</title>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#0b0f19" />
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <header>
    <h1>بسام الذكي — بحث عميق وتلقائي</h1>
    <button id="installBtn" hidden>تثبيت التطبيق</button>
  </header>

  <section class="card">
    <form id="searchForm">
      <input id="q" placeholder="اكتب سؤالك أو ما تريد البحث عنه" />
      <label><input type="checkbox" id="want_prices" /> إظهار روابط الأسعار</label>
      <button>بحث</button>
    </form>
    <div id="answer"></div>
    <div id="sources"></div>
  </section>

  <section class="grid">
    <div class="card">
      <h3>رفع PDF</h3>
      <form id="pdfForm">
        <input type="file" id="pdfFile" accept="application/pdf" />
        <button>رفع وفهرسة</button>
      </form>
      <div id="pdfResult"></div>
    </div>

    <div class="card">
      <h3>بحث بالصور</h3>
      <form id="imgForm">
        <input type="file" id="imgFile" accept="image/*" />
        <button>رفع والبحث</button>
      </form>
      <div id="imgResult"></div>
    </div>
  </section>

  <footer>© Bassam — يعمل كتطبيق PWA ويمكن تثبيته على الجوال</footer>

  <script src="/static/script.js"></script>
  <script>
    // PWA install
    let deferredPrompt; const btn = document.getElementById('installBtn');
    window.addEventListener('beforeinstallprompt', (e) => { e.preventDefault(); deferredPrompt = e; btn.hidden = false; });
    btn.addEventListener('click', async () => { if (!deferredPrompt) return; deferredPrompt.prompt(); deferredPrompt = null; btn.hidden = true; });
    if ('serviceWorker' in navigator) navigator.serviceWorker.register('/service-worker.js');
  </script>
</body>
</html>
