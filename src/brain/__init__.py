# src/brain/__init__.py โ ููุงุฉ ุจุณุงู ุงูุฐูู

import random
from datetime import datetime

# ูุงุนุฏุฉ ุจูุงูุงุช ูุคูุชุฉ ููุฐุงูุฑุฉ
memory_log = []


def safe_run(query: str) -> str:
    """
    ููุงุฉ ุงูุชูููุฑ ูู ุจุณุงู ุงูุฐูู โ ุงููุณุฎุฉ 1.0
    ุชููู ุจุชุญููู ุงูุณุคุงูุ ุงูุจุญุซ ุนู ููุทุ ูุงูุฑุฏ ุจุดูู ุฐูู ูุน ุญูุธ ุงูุฐุงูุฑุฉ.
    """

    # ุญูุธ ุงูุณุคุงู ูู ุงูุฐุงูุฑุฉ
    memory_log.append({"time": datetime.now(), "query": query})

    # --------------------------
    # ุงูุชุญููู ุงูุฃุณุงุณู
    # --------------------------
    q = query.strip().lower()

    # 1๏ธโฃ ุฑูุงุถูุงุช ุจุณูุทุฉ
    if any(x in q for x in ["+", "-", "*", "/", "x**", "sqrt", "ุชูุงูู", "ุงุดุชูุงู"]):
        return solve_math(q)

    # 2๏ธโฃ ุฃุณุฆูุฉ ุนุงูุฉ
    elif "ูู ูู" in q or "ูุง ูู" in q or "ุงูู" in q or "ูุชู" in q:
        return smart_answer(q)

    # 3๏ธโฃ ุฑุฏ ุงูุชุฑุงุถู ุฐูู
    else:
        return think_creatively(q)


def solve_math(q: str) -> str:
    """ูุนุงูุฌุฉ ุงูุฑูุงุถูุงุช"""
    try:
        from sympy import sympify
        result = sympify(q).evalf()
        return f"โ ุงููุงุชุฌ: {result}"
    except Exception:
        return "โ๏ธ ุนุฐุฑูุงุ ูู ุฃุชููู ูู ููู ุงููุนุงุฏูุฉุ ุฃุนุฏ ูุชุงุจุชูุง ุจุตูุบุฉ ุฃูุถุญ ูุซู: 2*x + 3."


def smart_answer(q: str) -> str:
    """ุฑุฏูุฏ ุฐููุฉ ููุฃุณุฆูุฉ ุงูุนุงูุฉ"""
    responses = [
        "๐ ุณุคุงู ุฌููู ุฌุฏูุง! ุงูููู ุชูุน ูู ุฌููุจ ุดุจู ุงูุฌุฒูุฑุฉ ุงูุนุฑุจูุฉ ูุนุงุตูุชูุง ุตูุนุงุก ๐พ๐ช.",
        "๐ก ูุจุฏู ุฃูู ุชุณุฃู ุนู ูุนูููุฉ ุนุงูุฉ โ ุฌุงุฑู ุงูุชูููุฑ...",
        "๐ค ุญุณุจ ูุนูููุงุชูุ ุงูุฌูุงุจ ูุนุชูุฏ ุนูู ุงูุณูุงูุ ูู ููููู ุงูุชูุถูุญ ุฃูุซุฑุ"
    ]
    return random.choice(responses)


def think_creatively(q: str) -> str:
    """ุฑุฏูุฏ ุฅุจุฏุงุนูุฉ ุนูุฏ ุนุฏู ุชุทุงุจู ุงูููุท"""
    ideas = [
        f"โจ ุณุคุงู ุฑุงุฆุน ูุง ุจุณุงู! ุณุฃุณุฌูู ูู ุงูุฐุงูุฑุฉ ูุฃุชุนููู ูุงุญููุง.",
        f"๐ค ูุฐุง ุณุคุงู ูุญุชุงุฌ ุจุญุซูุง ุฃุนููุ ุณุฃุถููู ููุงุฆูุฉ ุงูุชุทููุฑ ุงููุงุฏูุฉ.",
        f"๐ญ ุฃููุฑ ูู ูุฐุง ุงูุณุคุงู... ูุจุฏู ุฃูู ุชูุชุญ ุขูุงููุง ุฌุฏูุฏุฉ!"
    ]
    return random.choice(ideas)
